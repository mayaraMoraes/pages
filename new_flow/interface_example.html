<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flow Runner V2 - Novas Funcionalidades</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #111827;
            color: #F9FAFB;
            font-size: 14px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #6366F1;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            color: #9CA3AF;
            font-size: 16px;
        }

        .tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 30px;
            background: #1F2937;
            padding: 4px;
            border-radius: 8px;
        }

        .tab {
            flex: 1;
            padding: 12px 16px;
            background: transparent;
            border: none;
            color: #9CA3AF;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 14px;
        }

        .tab.active {
            background: #6366F1;
            color: white;
        }

        .tab:hover:not(.active) {
            background: #374151;
            color: #F9FAFB;
        }

        .panel {
            display: none;
        }

        .panel.active {
            display: block;
        }

        .modal {
            background: #1F2937;
            border-radius: 12px;
            padding: 24px;
            border: 1px solid #374151;
            margin-bottom: 30px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #374151;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #F9FAFB;
        }

        .close-btn {
            background: none;
            border: none;
            color: #9CA3AF;
            cursor: pointer;
            font-size: 20px;
            padding: 4px;
            border-radius: 4px;
        }

        .close-btn:hover {
            color: #F9FAFB;
            background: #374151;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #F9FAFB;
        }

        .form-label .required {
            color: #EF4444;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: #111827;
            border: 1px solid #374151;
            border-radius: 8px;
            color: #F9FAFB;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #6366F1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            background: #111827;
            border: 1px solid #374151;
            border-radius: 8px;
            color: #F9FAFB;
            font-size: 14px;
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: #6366F1;
        }

        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            background: #111827;
            border: 1px solid #374151;
            border-radius: 8px;
            color: #F9FAFB;
            font-size: 14px;
            min-height: 80px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox {
            width: 16px;
            height: 16px;
            accent-color: #6366F1;
        }

        .radio-group {
            display: flex;
            gap: 16px;
            margin-top: 8px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .radio {
            width: 16px;
            height: 16px;
            accent-color: #6366F1;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #6366F1;
            color: white;
        }

        .btn-primary:hover {
            background: #5B5BD6;
        }

        .btn-secondary {
            background: #374151;
            color: #F9FAFB;
        }

        .btn-secondary:hover {
            background: #4B5563;
        }

        .btn-danger {
            background: #EF4444;
            color: white;
        }

        .btn-danger:hover {
            background: #DC2626;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 12px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid #374151;
        }

        .condition-editor {
            background: #111827;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 16px;
            margin-top: 12px;
        }

        .condition-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .condition-rule {
            background: #1F2937;
            border: 1px solid #374151;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            display: grid;
            grid-template-columns: 1fr auto 1fr auto;
            gap: 8px;
            align-items: center;
        }

        .condition-rule select {
            padding: 6px 8px;
            background: #111827;
            border: 1px solid #374151;
            border-radius: 4px;
            color: #F9FAFB;
            font-size: 12px;
        }

        .condition-rule input {
            padding: 6px 8px;
            background: #111827;
            border: 1px solid #374151;
            border-radius: 4px;
            color: #F9FAFB;
            font-size: 12px;
        }

        .add-rule-btn {
            background: #059669;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .remove-rule-btn {
            background: #EF4444;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
        }

        .field-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .field-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
        }

        .help-text {
            font-size: 12px;
            color: #9CA3AF;
            margin-top: 4px;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            background: #374151;
            color: #F9FAFB;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .badge-primary {
            background: #6366F1;
            color: white;
        }

        .badge-success {
            background: #059669;
            color: white;
        }

        .badge-warning {
            background: #D97706;
            color: white;
        }

        .badge-danger {
            background: #EF4444;
            color: white;
        }

        .collapsible {
            border: 1px solid #374151;
            border-radius: 8px;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .collapsible-header {
            background: #1F2937;
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #374151;
        }

        .collapsible-content {
            padding: 16px;
            background: #111827;
        }

        .math-values {
            background: #111827;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 16px;
        }

        .math-value-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #1F2937;
            border-radius: 6px;
            margin-bottom: 8px;
        }

        .icon {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .function-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .function-type-card {
            background: #1F2937;
            border: 2px solid #374151;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .function-type-card:hover {
            border-color: #6366F1;
            background: #2D3748;
        }

        .function-type-card.selected {
            border-color: #6366F1;
            background: rgba(99, 102, 241, 0.1);
        }

        .function-type-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 12px;
            background: #6366F1;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .function-type-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .function-type-description {
            font-size: 12px;
            color: #9CA3AF;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Flow Runner V2 - Novas Funcionalidades</h1>
            <p>Exemplos de interface para as novas funcionalidades do sistema de flows</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('function-selector')">Seleção de Função</button>
            <button class="tab" onclick="showTab('create-variable')">CREATE_VARIABLE</button>
            <button class="tab" onclick="showTab('database-operation')">DATABASE_OPERATION</button>
            <button class="tab" onclick="showTab('math-operation')">MATH_OPERATION</button>
            <button class="tab" onclick="showTab('next-group')">Next Group</button>
        </div>

        <!-- Tab 1: Seleção do Tipo de Função -->
        <div id="function-selector" class="panel active">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">✨ Nova Função</h2>
                    <button class="close-btn">×</button>
                </div>

                <div class="form-group">
                    <label class="form-label">Selecione o tipo de função <span class="required">*</span></label>
                    <div class="function-type-selector">
                        <div class="function-type-card selected">
                            <div class="function-type-icon">🌐</div>
                            <div class="function-type-title">HTTP_REQUEST</div>
                            <div class="function-type-description">Fazer requisições HTTP para APIs externas</div>
                        </div>
                        <div class="function-type-card">
                            <div class="function-type-icon">📝</div>
                            <div class="function-type-title">CREATE_VARIABLE</div>
                            <div class="function-type-description">Criar variáveis dinâmicas, fixas ou condicionais</div>
                        </div>
                        <div class="function-type-card">
                            <div class="function-type-icon">🗃️</div>
                            <div class="function-type-title">DATABASE_OPERATION</div>
                            <div class="function-type-description">Operações CRUD no banco de dados MongoDB</div>
                        </div>
                        <div class="function-type-card">
                            <div class="function-type-icon">🧮</div>
                            <div class="function-type-title">MATH_OPERATION</div>
                            <div class="function-type-description">Operações matemáticas entre valores</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Nome da função <span class="required">*</span></label>
                    <input type="text" class="form-input" placeholder="ex: consultar_usuario">
                </div>

                <div class="form-group">
                    <label class="form-label">Grupo <span class="required">*</span></label>
                    <select class="form-select">
                        <option>Grupo 1 (#3482DD)</option>
                        <option>Grupo 2 (#FFAE45)</option>
                        <option>Grupo 3 (#28A745)</option>
                    </select>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary">Cancelar</button>
                    <button class="btn btn-primary">Continuar</button>
                </div>
            </div>
        </div>

        <!-- Tab 2: CREATE_VARIABLE -->
        <div id="create-variable" class="panel">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">📝 CREATE_VARIABLE</h2>
                    <span class="badge badge-primary">Grupo 1</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Nome da função <span class="required">*</span></label>
                    <input type="text" class="form-input" value="criar_status_usuario" placeholder="ex: criar_status_usuario">
                </div>

                <div class="form-group">
                    <label class="form-label">Tipo de variável <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="type_variable" value="FIXED" class="radio" checked>
                            <label>FIXED - Valor fixo</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="type_variable" value="DYNAMIC" class="radio">
                            <label>DYNAMIC - Valor dinâmico</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="type_variable" value="CONDITION" class="radio">
                            <label>CONDITION - Valor condicional</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Nome da variável <span class="required">*</span></label>
                    <input type="text" class="form-input" value="status_usuario" placeholder="ex: status_usuario">
                    <div class="help-text">Esta variável ficará disponível para uso em outras funções do flow</div>
                </div>

                <!-- FIXED Type Fields -->
                <div id="fixed-fields">
                    <div class="collapsible">
                        <div class="collapsible-header">
                            <span>⚙️ Configuração de Valor Fixo</span>
                            <span>▼</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="field-row">
                                <div class="form-group">
                                    <label class="form-label">Tipo do valor</label>
                                    <select class="form-select">
                                        <option value="STRING">STRING</option>
                                        <option value="NUMBER">NUMBER</option>
                                        <option value="BOOLEAN">BOOLEAN</option>
                                        <option value="DATE">DATE</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Valor</label>
                                    <input type="text" class="form-input" value="ativo" placeholder="ex: ativo, 123, true">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DYNAMIC Type Fields (hidden by default) -->
                <div id="dynamic-fields" style="display: none;">
                    <div class="collapsible">
                        <div class="collapsible-header">
                            <span>🔗 Configuração de Valor Dinâmico</span>
                            <span>▼</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="form-group">
                                <label class="form-label">Caminho do valor dinâmico</label>
                                <input type="text" class="form-input" placeholder="ex: consultar_usuario.output.body.* para ver opções disponíveis">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CONDITION Type Fields (hidden by default) -->
                <div id="condition-fields" style="display: none;">
                    <div class="collapsible">
                        <div class="collapsible-header">
                            <span>🎯 Configuração de Condições</span>
                            <span>▼</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="condition-editor">
                                <div class="condition-header">
                                    <span><strong>Condição 1</strong></span>
                                    <button class="btn btn-small add-rule-btn">+ Adicionar Condição</button>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Regras</label>
                                    <select class="form-select" style="width: 100px; display: inline-block; margin-right: 8px;">
                                        <option>AND</option>
                                        <option>OR</option>
                                    </select>
                                    
                                    <div class="condition-rule">
                                        <input type="text" placeholder="consultar_usuario.output.status" style="grid-column: 1;">
                                        <select style="grid-column: 2;">
                                            <option>==</option>
                                            <option>!=</option>
                                            <option>&gt;</option>
                                            <option>&lt;</option>
                                        </select>
                                        <input type="text" placeholder="200" style="grid-column: 3;">
                                        <button class="remove-rule-btn" style="grid-column: 4;">✕</button>
                                    </div>
                                </div>

                                <div class="field-row">
                                    <div class="form-group">
                                        <div class="checkbox-group">
                                            <input type="checkbox" class="checkbox" id="is-dynamic-1">
                                            <label for="is-dynamic-1">Valor dinâmico</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Tipo</label>
                                        <select class="form-select">
                                            <option>STRING</option>
                                            <option>NUMBER</option>
                                            <option>BOOLEAN</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Valor retornado</label>
                                    <input type="text" class="form-input" value="ativo" placeholder="ativo ou consultar_usuario.output.body.status">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary">Cancelar</button>
                    <button class="btn btn-primary">Salvar Função</button>
                </div>
            </div>
        </div>

        <!-- Tab 3: DATABASE_OPERATION -->
        <div id="database-operation" class="panel">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">🗃️ DATABASE_OPERATION</h2>
                    <span class="badge badge-success">Grupo 2</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Nome da função <span class="required">*</span></label>
                    <input type="text" class="form-input" value="salvar_usuario" placeholder="ex: salvar_usuario">
                </div>

                <div class="field-row">
                    <div class="form-group">
                        <label class="form-label">Tipo de operação <span class="required">*</span></label>
                        <select class="form-select" id="operation-type" onchange="toggleDatabaseFields()">
                            <option value="INSERT">INSERT - Inserir documento</option>
                            <option value="UPDATE">UPDATE - Atualizar documento</option>
                            <option value="DELETE">DELETE - Deletar documento</option>
                            <option value="GET">GET - Consultar documento</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Cluster <span class="required">*</span></label>
                        <select class="form-select">
                            <option>URI_MONGODB_LOCAL</option>
                            <option>URI_MONGODB_AIRES_CLIENTES</option>
                            <option>URI_MONGODB_AIRES_APIS</option>
                            <option>URI_MONGODB_AIRES_STAGE</option>
                        </select>
                    </div>
                </div>

                <div class="field-row">
                    <div class="form-group">
                        <label class="form-label">Database <span class="required">*</span></label>
                        <input type="text" class="form-input" value="usuarios" placeholder="ex: usuarios">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Collection <span class="required">*</span></label>
                        <input type="text" class="form-input" value="perfis" placeholder="ex: perfis">
                    </div>
                </div>

                <!-- Document Configuration (para INSERT e UPDATE) -->
                <div class="collapsible" id="document-config">
                    <div class="collapsible-header">
                        <span>📄 Configuração do Documento</span>
                        <span>▼</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" class="checkbox" id="is-dynamic-doc">
                                <label for="is-dynamic-doc">Documento dinâmico (usar objeto completo de outra função)</label>
                            </div>
                        </div>

                        <!-- Dynamic Document -->
                        <div id="dynamic-document" style="display: none;">
                            <div class="form-group">
                                <label class="form-label">Caminho do documento</label>
                                <input type="text" class="form-input" placeholder="ex: consultar_usuario.output.body.usuario">
                            </div>
                        </div>

                        <!-- Static Document Fields -->
                        <div id="static-document">
                            <div class="form-group">
                                <label class="form-label">Campos do documento</label>
                                <div class="math-values">
                                    <div class="math-value-item">
                                        <input type="text" class="form-input" value="nome" placeholder="Campo" style="width: 150px;">
                                        <select class="form-select" style="width: 100px;">
                                            <option>STRING</option>
                                            <option>NUMBER</option>
                                            <option>BOOLEAN</option>
                                            <option>OBJECT</option>
                                            <option>LIST</option>
                                        </select>
                                        <div class="checkbox-group">
                                            <input type="checkbox" class="checkbox">
                                            <label>Dinâmico</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" class="checkbox" checked>
                                            <label>Obrigatório</label>
                                        </div>
                                        <input type="text" class="form-input" value="João Silva" placeholder="Valor" style="flex: 1;">
                                        <button class="remove-rule-btn">✕</button>
                                    </div>
                                    <div class="math-value-item">
                                        <input type="text" class="form-input" value="email" placeholder="Campo" style="width: 150px;">
                                        <select class="form-select" style="width: 100px;">
                                            <option>STRING</option>
                                        </select>
                                        <div class="checkbox-group">
                                            <input type="checkbox" class="checkbox" checked>
                                            <label>Dinâmico</label>
                                        </div>
                                        <div class="checkbox-group">
                                            <input type="checkbox" class="checkbox" checked>
                                            <label>Obrigatório</label>
                                        </div>
                                        <input type="text" class="form-input" value="consultar_usuario.output.body.email" placeholder="Valor" style="flex: 1;">
                                        <button class="remove-rule-btn">✕</button>
                                    </div>
                                    <button class="btn btn-small add-rule-btn" style="margin-top: 8px;">+ Adicionar Campo</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filter Configuration (para UPDATE, DELETE e GET) -->
                <div class="collapsible" id="filter-config">
                    <div class="collapsible-header">
                        <span>🔍 Configuração do Filtro</span>
                        <span>▼</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="form-group">
                            <div class="help-text">Configure as regras para identificar quais documentos serão afetados pela operação</div>
                        </div>
                        <div class="condition-editor">
                            <div class="condition-header">
                                <span><strong>Regras de Filtro</strong></span>
                            </div>
                            
                            <div class="form-group">
                                <select class="form-select" style="width: 100px; display: inline-block; margin-right: 8px;">
                                    <option>AND</option>
                                    <option>OR</option>
                                </select>
                                
                                <div class="condition-rule">
                                    <input type="text" placeholder="email" style="grid-column: 1;">
                                    <select style="grid-column: 2;">
                                        <option>==</option>
                                        <option>!=</option>
                                        <option>&gt;</option>
                                        <option>&lt;</option>
                                        <option>&gt;=</option>
                                        <option>&lt;=</option>
                                        <option>in</option>
                                        <option>not in</option>
                                        <option>find</option>
                                    </select>
                                    <input type="text" placeholder="consultar_usuario.output.body.email" style="grid-column: 3;">
                                    <button class="remove-rule-btn" style="grid-column: 4;">✕</button>
                                </div>
                                
                                <div class="form-group" style="margin-top: 8px;">
                                    <div class="checkbox-group">
                                        <input type="checkbox" class="checkbox" checked>
                                        <label>Valor dinâmico</label>
                                    </div>
                                </div>
                                
                                <button class="btn btn-small add-rule-btn" style="margin-top: 8px;">+ Adicionar Regra</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary">Cancelar</button>
                    <button class="btn btn-primary">Salvar Função</button>
                </div>
            </div>
        </div>

        <!-- Tab 4: MATH_OPERATION -->
        <div id="math-operation" class="panel">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">🧮 MATH_OPERATION</h2>
                    <span class="badge badge-warning">Grupo 3</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Nome da função <span class="required">*</span></label>
                    <input type="text" class="form-input" value="calcular_total_desconto" placeholder="ex: calcular_total_desconto">
                </div>

                <div class="form-group">
                    <label class="form-label">Operação matemática <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="operation" value="SUM" class="radio">
                            <label>SUM - Soma</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="operation" value="SUBTRACTION" class="radio" checked>
                            <label>SUBTRACTION - Subtração</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="operation" value="MULTIPLICATION" class="radio">
                            <label>MULTIPLICATION - Multiplicação</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="operation" value="DIVISION" class="radio">
                            <label>DIVISION - Divisão</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Valores para operação <span class="required">*</span></label>
                    <div class="help-text">Mínimo 2 valores necessários. Para subtração/divisão: primeiro valor - segundo valor - terceiro valor...</div>
                    
                    <div class="math-values">
                        <div class="math-value-item">
                            <span style="width: 60px; text-align: center; color: #9CA3AF;">Valor 1</span>
                            <div class="checkbox-group">
                                <input type="checkbox" class="checkbox" checked>
                                <label>Dinâmico</label>
                            </div>
                            <input type="text" class="form-input" value="consultar_produto.output.body.preco" placeholder="Valor ou caminho dinâmico" style="flex: 1;">
                            <button class="remove-rule-btn">✕</button>
                        </div>
                        <div class="math-value-item">
                            <span style="width: 60px; text-align: center; color: #9CA3AF;">Valor 2</span>
                            <div class="checkbox-group">
                                <input type="checkbox" class="checkbox">
                                <label>Dinâmico</label>
                            </div>
                            <input type="text" class="form-input" value="50.00" placeholder="Valor ou caminho dinâmico" style="flex: 1;">
                            <button class="remove-rule-btn">✕</button>
                        </div>
                        <button class="btn btn-small add-rule-btn" style="margin-top: 8px;">+ Adicionar Valor</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Resultado esperado</label>
                    <div class="help-text">A função criará uma variável <code>calcular_total_desconto.output.result</code> que pode ser usada em outras funções</div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary">Cancelar</button>
                    <button class="btn btn-primary">Salvar Função</button>
                </div>
            </div>
        </div>

        <!-- Tab 5: Next Group Configuration -->
        <div id="next-group" class="panel">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">🔀 Configuração do Próximo Grupo</h2>
                    <span class="badge">Grupo 1</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Como determinar o próximo grupo? <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="next_group_type" value="finish" class="radio">
                            <label>Finalizar flow (último grupo)</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="next_group_type" value="specific" class="radio">
                            <label>Próximo grupo específico</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="next_group_type" value="conditional" class="radio" checked>
                            <label>Baseado em condições</label>
                        </div>
                    </div>
                </div>

                <!-- Specific Group (hidden by default) -->
                <div id="specific-group" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Próximo grupo</label>
                        <select class="form-select">
                            <option>Grupo 2</option>
                            <option>Grupo 3</option>
                            <option>Grupo 4</option>
                        </select>
                    </div>
                </div>

                <!-- Conditional Groups -->
                <div id="conditional-groups">
                    <div class="form-group">
                        <label class="form-label">Condições para próximo grupo</label>
                        <div class="help-text">Configure múltiplas condições. A primeira condição verdadeira será executada.</div>
                    </div>

                    <!-- Condition 1 -->
                    <div class="collapsible">
                        <div class="collapsible-header">
                            <span>📋 Condição 1 → Grupo 2</span>
                            <span>▼</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="field-row">
                                <div class="form-group">
                                    <label class="form-label">Ir para o grupo</label>
                                    <select class="form-select">
                                        <option selected>Grupo 2</option>
                                        <option>Grupo 3</option>
                                        <option>Grupo 4</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Operador</label>
                                    <select class="form-select">
                                        <option>AND</option>
                                        <option>OR</option>
                                    </select>
                                </div>
                            </div>

                            <div class="condition-editor">
                                <div class="condition-rule">
                                    <input type="text" value="calculate_net_debit_balance.output.body.success" placeholder="Caminho do valor" style="grid-column: 1;">
                                    <select style="grid-column: 2;">
                                        <option selected>==</option>
                                        <option>!=</option>
                                        <option>&gt;</option>
                                        <option>&lt;</option>
                                    </select>
                                    <input type="text" value="true" placeholder="Valor de comparação" style="grid-column: 3;">
                                    <button class="remove-rule-btn" style="grid-column: 4;">✕</button>
                                </div>
                                <button class="btn btn-small add-rule-btn" style="margin-top: 8px;">+ Adicionar Regra</button>
                            </div>
                        </div>
                    </div>

                    <!-- Condition 2 -->
                    <div class="collapsible">
                        <div class="collapsible-header">
                            <span>📋 Condição 2 → Grupo 3 (Erro)</span>
                            <span>▼</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="field-row">
                                <div class="form-group">
                                    <label class="form-label">Ir para o grupo</label>
                                    <select class="form-select">
                                        <option>Grupo 2</option>
                                        <option selected>Grupo 3</option>
                                        <option>Grupo 4</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Operador</label>
                                    <select class="form-select">
                                        <option>AND</option>
                                        <option>OR</option>
                                    </select>
                                </div>
                            </div>

                            <div class="condition-editor">
                                <div class="condition-rule">
                                    <input type="text" value="calculate_net_debit_balance.output.body.success" placeholder="Caminho do valor" style="grid-column: 1;">
                                    <select style="grid-column: 2;">
                                        <option>==</option>
                                        <option selected>!=</option>
                                        <option>&gt;</option>
                                        <option>&lt;</option>
                                    </select>
                                    <input type="text" value="true" placeholder="Valor de comparação" style="grid-column: 3;">
                                    <button class="remove-rule-btn" style="grid-column: 4;">✕</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-small add-rule-btn" style="margin-top: 16px;">+ Adicionar Condição</button>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary">Cancelar</button>
                    <button class="btn btn-primary">Salvar Configuração</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Hide all panels
            document.querySelectorAll('.panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected panel
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Radio button change handlers
        document.querySelectorAll('input[name="type_variable"]').forEach(radio => {
            radio.addEventListener('change', function() {
                // Hide all type-specific fields
                document.getElementById('fixed-fields').style.display = 'none';
                document.getElementById('dynamic-fields').style.display = 'none';
                document.getElementById('condition-fields').style.display = 'none';
                
                // Show relevant fields
                if (this.value === 'FIXED') {
                    document.getElementById('fixed-fields').style.display = 'block';
                } else if (this.value === 'DYNAMIC') {
                    document.getElementById('dynamic-fields').style.display = 'block';
                } else if (this.value === 'CONDITION') {
                    document.getElementById('condition-fields').style.display = 'block';
                }
            });
        });

        document.querySelectorAll('input[name="next_group_type"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.getElementById('specific-group').style.display = 'none';
                document.getElementById('conditional-groups').style.display = 'none';
                
                if (this.value === 'specific') {
                    document.getElementById('specific-group').style.display = 'block';
                } else if (this.value === 'conditional') {
                    document.getElementById('conditional-groups').style.display = 'block';
                }
            });
        });

        // Dynamic document checkbox
        document.getElementById('is-dynamic-doc').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('dynamic-document').style.display = 'block';
                document.getElementById('static-document').style.display = 'none';
            } else {
                document.getElementById('dynamic-document').style.display = 'none';
                document.getElementById('static-document').style.display = 'block';
            }
        });

        // Function type card selection
        document.querySelectorAll('.function-type-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.function-type-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        function toggleDatabaseFields() {
            const operationType = document.getElementById('operation-type').value;
            const documentConfig = document.getElementById('document-config');
            const filterConfig = document.getElementById('filter-config');

            // Resetar visibilidade
            documentConfig.style.display = 'none';
            filterConfig.style.display = 'none';

            // Mostrar campos baseado no tipo de operação
            if (operationType === 'INSERT') {
                // INSERT: apenas documento
                documentConfig.style.display = 'block';
            } else if (operationType === 'UPDATE') {
                // UPDATE: documento + filtro
                documentConfig.style.display = 'block';
                filterConfig.style.display = 'block';
            } else if (operationType === 'DELETE' || operationType === 'GET') {
                // DELETE e GET: apenas filtro
                filterConfig.style.display = 'block';
            }
        }

        // Inicializar com INSERT selecionado
        document.addEventListener('DOMContentLoaded', function() {
            toggleDatabaseFields();
        });
    </script>
</body>
</html> 